@model ISas.Entities.FeesEntities.Fee_OnlineSettlementEntities
@{
    
}
<section class="content-header">
    <h1>Online Settlement</h1>
    <ol class="breadcrumb">
        <li>
            <a href="javascript: history.go(-1)" title="Back"><i class="fa fa-arrow-left"></i> </a> |
            <a href="#" onclick="window.location.reload()" title="Refresh"><i class="fa fa-refresh"></i></a> |
            <a href="@Url.Action("Dashboard", "Dashboard")" title="Dashboard"><i class="fa fa-dashboard"></i></a>
        </li>
        <li>Fee</li>
        <li>Online Settlement</li>
    </ol>
</section>

<section class="content">
    @using (Html.BeginForm("ImportExcel", "Fee_OnlineSettlement", FormMethod.Post, htmlAttributes: new { enctype = "multipart/form-data" }))
    {
        <div class="box box-success">
            <div class="box-body">
                <div class="row">
                    

                    <div class="col-xs-12 col-sm-6 col-md-2">
                        <div class="form-group">
                            <label>Date</label>
                            <div class="input-group">
                                <button type="button" class="btn btn-default pull-right" id="daterange-btn">
                                    <span>
                                        <i class="fa fa-calendar"></i> Selected Date
                                    </span>
                                    <i class="fa fa-caret-down"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 col-md-1">
                        <div class="form-group">
                            <div class="select">
                                <h2>
                                    <button type="button" class="btn btn-success" onclick="getOnlinesettlementList()">   <i class="fa fa-search btnDefaultColor"></i> </button>
                                </h2>
                            </div>
                        </div>
                    </div>

                </div>
                <hr />
                <div class="row">
                    <div class="col-md-12">
                        <div style="width:100%;overflow-y:auto;">
                            <div id="studentReportMainDiv"></div>
                        </div>



                    </div>
                </div>

                
            </div>
        </div>
    }
</section>

<script>
    function getOnlinesettlementList() {
        var daterange = $('#daterange-btn span').text();
        $.ajax({
            type: "GET",
            beforeSend: function () {
                spinnerShow();
            },
            url: "../Fee_OnlineSettlement/_GetOnlineSettlementList",
            data: {
                daterange: daterange
            },
            error: function (xhr, status, error) {
                OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
            },
            success: function (result) {

                $('#studentReportMainDiv').html(result);
            },
            complete: function () {
                spinnerHide();
            }
        });

    }

    //function DoAjaxPostAndMore(btnClicked) {
    //    if ($('#ConcessionCategoryId').val() == '' || $('#ConcessionCategoryId').val() == null) {
    //        OpenMessegeAutoHideDiv('Please select concession reason first..!', 'Info');
    //        return false;
    //    }
    //    var $form = $(btnClicked).parents('form');
    //    $.ajax({
    //        type: "POST",
    //        beforeSend: function () {
    //            spinnerShow();
    //        },
    //        url: $form.attr('action'),
    //        data: $form.serialize(),
    //        error: function (xhr, status, error) {
    //            OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
    //        },
    //        success: function (response) {
    //            if (response.status == 'success') {
    //                OpenMessegeAutoHideDiv(response.Msg, response.Color);
    //                getCreditNoteOrConcessionList();
    //            }
    //            else {
    //                OpenMessegeAutoHideDiv($('#ErrorMsgOnModelStateNotValid').val());
    //                AddErrorAttributeCSS(response.ErrorList); //Available in CustomCommon.js
    //                AddValidAttributeCSS(response.ValidKeyList); //Available in CustomCommon.js
    //            }
    //        },
    //        complete: function () {
    //            spinnerHide();
    //        }
    //    });
    //}

    //function UploadExcel(btnClicked) {
    //    alert("I am in fuction")
    //    var daterange = $('#daterange-btn span').text();

    //    //var $form = $(btnClicked).parents('form');


    //    var fileUpload = $("#SettlementInputFile").get(0);
    //    var files = fileUpload.files;
    //    alert(files);
    //    // Create FormData object
    //    var fileData = new FormData();

    //    // Looping over all files and add it to FormData object
    //    for (var i = 0; i < files.length; i++) {
    //        fileData.append(files[i].name, files[i]);
    //    }
    //    fileData.append('dateRange', daterange);

    //    //alert(fileData);
    //    $.ajax({
    //        type: "POST",
    //        beforeSend: function () {
    //            spinnerShow();
    //        },
    //        url: "../Fee_OnlineSettlement/Index",
    //        //enctype: 'multipart/form-data',
    //        contentType: false,
    //        processData: false,
    //        //data: { fileData, dateRange: daterange },
    //        data: fileData,
    //        //data: daterange,
    //        error: function (xhr, status, error) {
    //            OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
    //        },
    //        success: function (response) {
    //            if (response.status == 'success') {
    //                OpenMessegeAutoHideDiv(response.Msg, response.Color);
    //                getCreditNoteOrConcessionList();
    //            }
    //            else {
    //                OpenMessegeAutoHideDiv($('#ErrorMsgOnModelStateNotValid').val());
    //                AddErrorAttributeCSS(response.ErrorList); //Available in CustomCommon.js
    //                AddValidAttributeCSS(response.ValidKeyList); //Available in CustomCommon.js
    //            }
    //        },
    //        complete: function () {
    //            spinnerHide();
    //        }
    //    });
    //}

</script>

<script>
    $(function () {
        $('#daterange-btn').daterangepicker(
            {
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                startDate: moment().subtract(29, 'days'),
                endDate: moment()
            },
            function (start, end) {
                $('#daterange-btn span').html(start.format('DD/MM/YYYY') + ' - ' + end.format('DD/MM/YYYY'))
            }
        )


    });
</script>