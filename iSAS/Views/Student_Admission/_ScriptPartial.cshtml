<script type="text/javascript">
    $('.upload').on('change', function (e) {

        alert('ffff');

        var currentImageID = "";

        var i = $(this).closest('tr').attr('id');
        var forDocType = $(this).closest('td').attr('id');

        if (forDocType == 'S') {
            currentImageID = "selfImg_";
        } else if (forDocType == 'F') {
            currentImageID = "fatherImg_";
        }
        else if (forDocType == 'M') {
            currentImageID = "motherImg_";
        }
        else if (forDocType == 'G') {
            currentImageID = "GardianImg_";
        }
        else if (forDocType == 'GF') {
            currentImageID = "GFImg_";
        }
        else if (forDocType == 'GM') {
            currentImageID = "GMImg_";
        }
        else if (forDocType == 'P') {
            currentImageID = "PImg_";
        }

        if (this.files && this.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#' + currentImageID + i)
                    .attr('src', e.target.result)
                    .width(95)
                    .height(95);
            };
            reader.readAsDataURL(this.files[0]);
        }


        var files = e.target.files;
        if (files.length > 0) {
            if (window.FormData !== undefined) {
                var data = new FormData();
                for (var x = 0; x < files.length; x++) {

                    data.append("id" + x, files[x]);
                }
                data.append('StudentERPNo', $('#ClassPhotoList_' + i + '__Student_StudentERPNo').val());

                data.append('ForDocType', forDocType);

                $.ajax({
                    type: "POST",
                    //url: '/Student_PhotoUpload/UploadFile',
                    url: '@Url.Action("UploadFile", "Student_PhotoUpload")',
                    //url: '/Student_PhotoUpload/UploadFile',
                    dataType: 'json',
                    contentType: false,
                    processData: false,
                    data: data,
                    success: function (result) {
                        //$('#' + currentImageID + i).attr('src', e.target.result).width(120).height(120);
                        alert(result);
                    },
                    error: function (xhr, status, p3, p4) {
                        var err = "Error " + " " + status + " " + p3 + " " + p4;
                        if (xhr.responseText && xhr.responseText[0] == "{")
                            err = JSON.parse(xhr.responseText).Message;
                        console.log(err);
                    }
                });
            } else {
                alert("This browser doesn't support HTML5 file uploads!");
            }
        }
    });
</script>