@model ISas.Entities.DashboardEntities.DashboardModel_Admin
<!-- Content Header (Page header) -->
<style>
    #chartdiv {
        width: 100%;
        height: 300px;
    }

    #chartdiv_donnat {
        width: 100%;
        height: 300px;
    }

    #chartdiv_strength {
        width: 100%;
        height: 400px;
    }
</style>
<section class="content-header">
    <ol class="breadcrumb">
        <li>
            <a href="#" onclick="window.location.reload()" title="Refresh"><i class="fa fa-refresh"></i></a> |
            <a href="javascript: history.go(-1)" title="Back"><i class="fa fa-arrow-left"></i> </a> |
            <i class="fa fa-dashboard"></i>
        </li>
    </ol>
</section>
<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-md-12">
            &nbsp;
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="box box-widget widget-user">
                <!-- Add the bg color to the header using any of the bg-* classes -->
                <div class="widget-user-header bg-aqua-active">
                    <h6 class="widget-user-desc pull-right"><u>@Html.ActionLink("More Info", "FeeCollectionDetails", "DashBoard_StudentStatatics", new { }, htmlAttributes: new { style = "color:white;" })</u></h6>
                    <h3 class="widget-user-username">Fee Collection</h3>
                    <h5 class="widget-user-desc">@DateTime.Now.ToShortDateString()</h5>
                </div>
                <div class="widget-user-image">
                    <img class="img-rounded" src="../Images/System/rupeeIcon.png" alt="User Avatar">
                </div>
                <div class="box-footer">
                    <div class="row">
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.FeeCollection.CASH)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.FeeCollection.CASH)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.FeeCollection.CHEQUE)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.FeeCollection.CHEQUE)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.FeeCollection.ONLINE)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.FeeCollection.ONLINE)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.FeeCollection.TOTAL)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.FeeCollection.TOTAL)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                    </div>
                    <!-- /.row -->
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="box box-widget widget-user">
                <!-- Add the bg color to the header using any of the bg-* classes -->
                <div class="widget-user-header bg-yellow">
                    <h3 class="widget-user-username">Transport Collection</h3>
                    <h5 class="widget-user-desc">@DateTime.Now.ToShortDateString()</h5>
                </div>
                <div class="widget-user-image">
                    <img class="img-rounded" src="../Images/System/busIcon.png" alt="User Avatar">
                </div>
                <div class="box-footer">
                    <div class="row">
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.TransportCollection.CASH)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.TransportCollection.CASH)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.TransportCollection.CHEQUE)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.TransportCollection.CHEQUE)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.TransportCollection.ONLINE)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.TransportCollection.ONLINE)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.TransportCollection.TOTAL)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.TransportCollection.TOTAL)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="box box-widget widget-user">
                <!-- Add the bg color to the header using any of the bg-* classes -->
                <div class="widget-user-header bg-green-gradient">
                    <h6 class="widget-user-desc pull-right"><u> @Html.ActionLink("More Info", "StudentAdmissionDetails", "DashBoard_StudentStatatics", new { }, htmlAttributes: new { style = "color:white" })</u></h6>
                    <h3 class="widget-user-username">Admission Details</h3>
                    <h5 class="widget-user-desc">@DateTime.Now.ToShortDateString()</h5>
                </div>
                <div class="widget-user-image">
                    <img class="img-rounded" src="../Images/System/userIcon.png" alt="User Avatar">
                </div>
                <div class="box-footer">
                    <div class="row">
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.AdmissionDetails.Registration)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.AdmissionDetails.Registration)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.AdmissionDetails.Admission)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.AdmissionDetails.Admission)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <!-- /.col -->
                        <div class="col-sm-3 border-right">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.AdmissionDetails.NSO)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.AdmissionDetails.NSO)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                        <div class="col-sm-3">
                            <div class="description-block">
                                <h5 class="description-header">@Html.DisplayFor(r => Model.AdmissionDetails.TC)</h5>
                                <span class="description-text">@Html.DisplayNameFor(r => Model.AdmissionDetails.TC)</span>
                            </div>
                            <!-- /.description-block -->
                        </div>
                        <!-- /.col -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h5 class="box-title">Student Attendance on @DateTime.Now.ToShortDateString()</h5>
                </div>
                <div class="box-body">
                    <div id="chartdiv_donnat"></div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h5 class="box-title">Staff Attendance on @DateTime.Now.ToShortDateString()</h5>
                </div>
                <div class="box-body">
                    <div id="chartdiv"></div>
                </div>
            </div>
        </div>
    </div>


    <div class="row">

        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h5 class="box-title">School Strength Details</h5>
                    <h5 class="box-title pull-right">Total Strength : <span style="font-weight:800;font-size:20px;" class="text-primary" id="spanTotalStrength">0</span></h5>
                </div>
                <div class="box-body">
                    <div id="chartdiv_strength"></div>
                </div>
            </div>
        </div>
    </div>
</section>
<script src="~/bower_components/newchart.js/amcharts.js"></script>
<script src="~/bower_components/newchart.js/export.min.js"></script>
<script src="~/bower_components/newchart.js/light.js"></script>
<script src="~/bower_components/newchart.js/pie.js"></script>
<script src="~/bower_components/newchart.js/serial.js"></script>
<link href="~/bower_components/newchart.css/export.css" rel="stylesheet" />

<script>
    $(function () {
        $.ajax({
            type: "GET",
            url: "../Dashboard/GetAttenSummery",
            data: {},
            error: function (xhr, status, error) {
                OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
            },
            success: function (result) {

                //console.log(result);
                //console.log(result);

                var chart_Donnat = AmCharts.makeChart("chartdiv_donnat", {
                    "type": "pie",
                    "theme": "light",
                    "innerRadius": "40%",
                    "gradientRatio": [-0.4, -0.4, -0.4, -0.4, -0.4, -0.4, 0, 0.1, 0.2, 0.1, 0, -0.2, -0.5],
                    "dataProvider": result,
                    "balloonText": "[[value]]",
                    "valueField": "NoOfStudent",
                    "titleField": "AttenStatus",
                    "balloon": {
                        "drop": true,
                        "adjustBorderColor": false,
                        "color": "#FFFFFF",
                        "fontSize": 16
                    },
                    "export": {
                        "enabled": true
                    }
                });

            },
        })
    });
</script>
<script>
    $(function () {
        $.ajax({
            type: "GET",
            url: "../Dashboard/GetStudentStrength",
            data: {},
            error: function (xhr, status, error) {
                OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
            },
            success: function (result) {
                var str = result.Strength;
                $('#spanTotalStrength').html(result.TotalStrength);
                var chart = AmCharts.makeChart("chartdiv_strength", {
                    "type": "serial",
                    "theme": "light",
                    "depth3D": 20,
                    "angle": 30,
                    "legend": {
                        "horizontalGap": 10,
                        "useGraphSettings": true,
                        "markerSize": 10
                    },
                    "dataProvider": JSON.parse(str),
                    "valueAxes": [{
                        "stackType": "regular",
                        "axisAlpha": 0,
                        "gridAlpha": 0
                    }],
                    "graphs": result.Sections,
                    "categoryField": "ClassName",
                    "categoryAxis": {
                        "gridPosition": "start",
                        "axisAlpha": 0,
                        "gridAlpha": 0,
                        "position": "left"
                    },
                    "export": {
                        "enabled": true
                    }
                });
            },
        })
    });
</script>
<script>
    $(function () {
        $.ajax({
            type: "GET",
            url: "../Dashboard/GetStaffAttendance",
            data: {},
            error: function (xhr, status, error) {
                OpenMessegeAutoHideDiv($('#ErrorMsgOnJasonFailed').val(), 'Danger');
            },
            success: function (result) {
                var chart = AmCharts.makeChart("chartdiv", {
                    "theme": "light",
                    "type": "serial",
                    "dataProvider": result.staffAtten,
                    "valueAxes": [{
                        "stackType": "3d",
                        "unit": "",
                        "position": "left",
                        "title": "No of Staff",
                    }],
                    "startDuration": 1,
                    "graphs": [{
                        "balloonText": "(Leave): <b>[[value]]</b>",
                        "fillAlphas": 2,
                        "lineAlpha": 1,
                        "title": "Leave",
                        "type": "column",
                        "valueField": "Leave"
                    }, {
                        "balloonText": "(Absent): <b>[[value]]</b>",
                        "fillAlphas": 40,
                        "lineAlpha": 2,
                        "title": "Absent",
                        "type": "column",
                        "valueField": "Absent"
                    },
                    {
                        "balloonText": "(Present): <b>[[value]]</b>",
                        "fillAlphas": 1,
                        "lineAlpha": 2,
                        "title": "Present",
                        "type": "column",
                        "valueField": "Present"
                    }],
                    "plotAreaFillAlphas": 1,
                    "depth3D": 40,
                    "angle": 30,
                    "categoryField": "Class",
                    "categoryAxis": {
                        "gridPosition": "start"
                    },
                    "export": {
                        "enabled": true
                    }
                });
            },
        })
    });
</script>
<script>
    jQuery('.chart-input').off().on('input change', function () {
        var property = jQuery(this).data('property');
        var target = chart;
        chart.startDuration = 0;

        if (property == 'topRadius') {
            target = chart.graphs[0];
            if (this.value == 0) {
                this.value = undefined;
            }
        }

        target[property] = this.value;
        chart.validateNow();
    });
</script>
