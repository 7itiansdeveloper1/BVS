@using ISas.Web.Models;
@model  ISas.Entities.FeesEntities.Fee_FilterDefaulterDetailModel

@{
    string reportName = "Defaulter Report";
}
<div style="display:none;">
    @{ Html.RenderAction("_ReportHeader", "Common", new { tempReportName = @reportName });}
</div>
<hr />

<table id="example1" class="table table-responsive table-bordered table-condensed nowrap" style="width:100%">
    <thead>
        <tr>
            <th>
                @Html.CheckBox("chkBoxSelectAll", false, htmlAttributes: new { onchange = "fun_chekcToSelectAllDefaulter()"})
            </th>
            <th>#</th>
            <th>Adm. No</th>
            <th>Student Name</th>
            <th>Father Name</th>
            <th>Class</th>
            <th>Due Amt.</th>
            <th>Mobile No</th>
            <th>Installment</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        @if (Model != null && Model.DefaulterList != null && Model.DefaulterList.Count > 0)
        {
            int count = 1;
            for (int i = 0; i < Model.DefaulterList.Count; i++)
            {
                <tr>
                    <td>
                        @Html.CheckBoxFor(r => Model.DefaulterList[i].Selected, htmlAttributes: new { onchange = "getSelectCount()", @class = "clsChkBoxDefaulter" })

                        @Html.HiddenFor(r => Model.DefaulterList[i].ERPNo)
                        @Html.HiddenFor(r => Model.DefaulterList[i].SMSNo)
                        @Html.HiddenFor(r => Model.DefaulterList[i].AdmNo)
                        @Html.HiddenFor(r => Model.DefaulterList[i].Student)
                        @Html.HiddenFor(r => Model.DefaulterList[i].FatherName)
                        @Html.HiddenFor(r => Model.DefaulterList[i].Class)
                        @Html.HiddenFor(r => Model.DefaulterList[i].Balance)
                        @Html.HiddenFor(r => Model.DefaulterList[i].Duration)
                    </td>
                    <td>@Html.DisplayFor(r => count)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].AdmNo)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].Student)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].FatherName)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].Class)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].Balance)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].SMSNo)</td>
                    <td>@Html.DisplayFor(r => Model.DefaulterList[i].Duration)</td>
                    <td>
                        @Html.EncodedActionLink(" ", "NewFeeReceipt", "Fee_Transaction", new { erpNo = Model.DefaulterList[i].ERPNo }, htmlAttributes: new { @class = "fa  fa-book btnDefaultColor", title = "Go to New Receipt" })
                    </td>
                </tr>
                count++;
            }
            count++;
        }
    </tbody>
</table>
<div class="row">
    <div class="col-xs-6">
        <p class="lead">Record Statatics: </p>
        <div class="table-responsive">
            <table class="table table-bordered table table-hover">
                <thead>
                    <tr>
                        @foreach (var item in Model.HeaderNameList2)
                        {
                            <th>@Html.DisplayFor(r => item) </th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.ValueList2.Count; i++)
                    {
                        <tr>
                            @for (int j = 0; j < Model.ValueList2[i].Count; j++)
                            {
                                <td>@Html.DisplayFor(r => Model.ValueList2[i][j])</td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
    <div class="col-xs-6">
        <p class="lead">Grand Total:</p>
        <div class="table-responsive">
            <table class="table table-bordered table table-hover">
                <thead>
                    <tr>
                        @foreach (var item in Model.HeaderNameList1)
                        {
                            <th>@Html.DisplayFor(r => item) </th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.ValueList1.Count; i++)
                    {
                        <tr>
                            @for (int j = 0; j < Model.ValueList1[i].Count; j++)
                            {
                                <td>@Html.DisplayFor(r => Model.ValueList1[i][j])</td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    function fun_chekcToSelectAllDefaulter() {
        if ($('#chkBoxSelectAll').is(':checked')) {
            $('.clsChkBoxDefaulter').prop('checked', true);
        } else {
            $('.clsChkBoxDefaulter').prop('checked', false);
        }
        getSelectCount();
    }

    $("#example1 tr").click(function (evt) {
        if (evt.ctrlKey) {
            $(this).toggleClass("selected");
        } else {
            var selected = $(this).hasClass("selected");
            $("#example1 tr").removeClass("selected");
            if (!selected)
                $(this).addClass("selected");
        }
    });

    $(document).ready(function () {
        $('#example1').DataTable({
            "pageLength": 50,
            dom: 'Bfrtip',
            buttons: [
                {
                    extend: 'excelHtml5',
                    text: '<i class="fa fa-file-excel-o"></i>',
                    titleAttr: 'Excel',
                    title: '@reportName',
                    exportOptions: {
                        columns: ':visible'
                    },
                    customize: function (xlsx) {
                        console.log(xlsx);

                    }
                },
                'colvis'
            ],
            select: true
        });
    });
</script>
<script>
    $(function () {
        if ('@Model' != null && parseInt('@Model.DefaulterList.Count') > 0) {
            $('#btnPrint').attr('disabled', false);
        } else {
            $('#btnPrint').attr('disabled', true);
        }
    });
</script>


